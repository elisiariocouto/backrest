function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,a){Object.defineProperty(e,t,{get:r,set:a,enumerable:!0,configurable:!0})}var r=globalThis.parcelRequire233b,a=r.register;a("fZ7PI",function(a,n){t(a.exports,"RepoView",()=>R);var l=r("ayMG0"),o=r("acw62"),s=r("4Uh7a"),i=r("h5DBq"),c=r("4RmmN"),u=r("VoMtX"),d=r("93lJr"),p=r("fz9dF"),f=r("a7ovc"),h=r("bNqR0"),m=r("cT7kT"),y=r("1Yxub"),x=r("2qtef"),g=r("1VQWV"),v=r("3JMMO"),k=r("dkYnv"),w=r("lPKqJ");let S=e(o).lazy(()=>r("cLBHq")),R=({repo:e})=>{let[t,a]=(0,g.useConfig)(),n=(0,k.useShowModal)(),R=(0,v.useAlertApi)(),b=async()=>{try{await y.backrestService.doRepoTask((0,w.create)(m.DoRepoTaskRequestSchema,{repoId:e.id,task:m.DoRepoTaskRequest_Task.INDEX_SNAPSHOTS}))}catch(e){R.error((0,v.formatErrorAlert)(e,"Failed to index snapshots: "))}},j=async()=>{try{R.info("Unlocking repo..."),await y.backrestService.doRepoTask((0,w.create)(m.DoRepoTaskRequestSchema,{repoId:e.id,task:m.DoRepoTaskRequest_Task.UNLOCK})),R.success("Repo unlocked.")}catch(e){R.error("Failed to unlock repo: "+e.message)}},O=async()=>{try{await y.backrestService.doRepoTask((0,w.create)(m.DoRepoTaskRequestSchema,{repoId:e.id,task:m.DoRepoTaskRequest_Task.STATS}))}catch(e){R.error((0,v.formatErrorAlert)(e,"Failed to compute stats: "))}},C=async()=>{try{await y.backrestService.doRepoTask((0,w.create)(m.DoRepoTaskRequestSchema,{repoId:e.id,task:m.DoRepoTaskRequest_Task.PRUNE}))}catch(e){R.error((0,v.formatErrorAlert)(e,"Failed to prune: "))}},T=async()=>{try{await y.backrestService.doRepoTask((0,w.create)(m.DoRepoTaskRequestSchema,{repoId:e.id,task:m.DoRepoTaskRequest_Task.CHECK}))}catch(e){R.error((0,v.formatErrorAlert)(e,"Failed to check: "))}},N=t?.repos?.find(t=>t.id===e.id);if(!N)return(0,l.jsxs)(l.Fragment,{children:["Repo was deleted",(0,l.jsx)("pre",{children:JSON.stringify(t,null,2)})]});e=N;let A=[{key:"1",label:"Tree View",children:(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(f.OperationTreeView,{req:(0,w.create)(m.GetOperationsRequestSchema,{selector:{repoGuid:e.guid},lastN:BigInt(h.MAX_OPERATION_HISTORY)})})}),destroyOnHidden:!0},{key:"2",label:"List View",children:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h3",{children:"Backup Action History"}),(0,l.jsx)(p.OperationListView,{req:(0,w.create)(m.GetOperationsRequestSchema,{selector:{repoGuid:e.guid},lastN:BigInt(h.MAX_OPERATION_HISTORY)}),showPlan:!0,showDelete:!0})]}),destroyOnHidden:!0},{key:"3",label:"Stats",children:(0,l.jsx)(o.Suspense,{fallback:(0,l.jsx)("div",{children:"Loading..."}),children:(0,l.jsx)(S,{selector:(0,w.create)(m.OpSelectorSchema,{repoGuid:e.guid,instanceId:t?.instance})})}),destroyOnHidden:!0}];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.default,{gap:"small",align:"center",wrap:"wrap",children:(0,l.jsx)(d.default.Title,{children:e.id})}),(0,l.jsxs)(i.default,{gap:"small",align:"center",wrap:"wrap",children:[(0,l.jsx)(u.default,{title:"Advanced users: open a restic shell to run commands on the repository. Re-index snapshots to reflect any changes in Backrest.",children:(0,l.jsx)(s.default,{type:"default",onClick:async()=>{let{RunCommandModal:t}=await r("lkdpj");n((0,l.jsx)(t,{repo:e}))},children:"Run Command"})}),(0,l.jsx)(u.default,{title:"Indexes the snapshots in the repository. Snapshots are also indexed automatically after each backup.",children:(0,l.jsx)(x.SpinButton,{type:"default",onClickAsync:b,children:"Index Snapshots"})}),(0,l.jsx)(u.default,{title:"Removes lockfiles and checks the repository for errors. Only run if you are sure the repo is not being accessed by another system",children:(0,l.jsx)(x.SpinButton,{type:"default",onClickAsync:j,children:"Unlock Repo"})}),(0,l.jsx)(u.default,{title:"Runs a prune operation on the repository that will remove old snapshots and free up space",children:(0,l.jsx)(x.SpinButton,{type:"default",onClickAsync:C,children:"Prune Now"})}),(0,l.jsx)(u.default,{title:"Runs a check operation on the repository that will verify the integrity of the repository",children:(0,l.jsx)(x.SpinButton,{type:"default",onClickAsync:T,children:"Check Now"})}),(0,l.jsx)(u.default,{title:"Runs restic stats on the repository, this may be a slow operation",children:(0,l.jsx)(x.SpinButton,{type:"default",onClickAsync:O,children:"Compute Stats"})})]}),(0,l.jsx)(c.default,{defaultActiveKey:A[0].key,items:A})]})}}),a("h5DBq",function(a,n){t(a.exports,"default",()=>f);var l=r("acw62"),o=r("8g1PZ"),s=r("1pcHX"),i=r("hMaQy"),c=r("aT8OD"),u=r("8zQmX"),d=r("5XBQv"),p=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)0>t.indexOf(a[n])&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]]);return r},f=e(l).forwardRef((t,r)=>{let{prefixCls:a,rootClassName:n,className:f,style:h,flex:m,gap:y,vertical:x=!1,component:g="div",children:v}=t,k=p(t,["prefixCls","rootClassName","className","style","flex","gap","vertical","component","children"]),{flex:w,direction:S,getPrefixCls:R}=e(l).useContext(c.ConfigContext),b=R("flex",a),[j,O,C]=(0,u.default)(b),T=null!=x?x:null==w?void 0:w.vertical,N=e(o)(f,n,null==w?void 0:w.className,b,O,C,(0,d.default)(b,t),{[`${b}-rtl`]:"rtl"===S,[`${b}-gap-${y}`]:(0,i.isPresetSize)(y),[`${b}-vertical`]:T}),A=Object.assign(Object.assign({},null==w?void 0:w.style),h);return m&&(A.flex=m),y&&!(0,i.isPresetSize)(y)&&(A.gap=y),j(e(l).createElement(g,Object.assign({ref:r,className:N,style:A},(0,s.default)(k,["justify","wrap","align"])),v))})}),a("hMaQy",function(e,r){function a(e){return["small","middle","large"].includes(e)}function n(e){return!!e&&"number"==typeof e&&!Number.isNaN(e)}t(e.exports,"isPresetSize",()=>a),t(e.exports,"isValidGapNumber",()=>n)}),a("8zQmX",function(e,a){t(e.exports,"default",()=>s);var n=r("1kAJu"),l=r("1nWFx"),o=r("5XBQv"),s=(0,n.genStyleHooks)("Flex",e=>{let{paddingXS:t,padding:r,paddingLG:a}=e,n=(0,l.mergeToken)(e,{flexGapSM:t,flexGap:r,flexGapLG:a});return[(e=>{let{componentCls:t}=e;return{[t]:{display:"flex",margin:0,padding:0,"&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}})(n),(e=>{let{componentCls:t}=e;return{[t]:{"&-gap-small":{gap:e.flexGapSM},"&-gap-middle":{gap:e.flexGap},"&-gap-large":{gap:e.flexGapLG}}}})(n),(e=>{let{componentCls:t}=e,r={};return o.flexWrapValues.forEach(e=>{r[`${t}-wrap-${e}`]={flexWrap:e}}),r})(n),(e=>{let{componentCls:t}=e,r={};return o.alignItemsValues.forEach(e=>{r[`${t}-align-${e}`]={alignItems:e}}),r})(n),(e=>{let{componentCls:t}=e,r={};return o.justifyContentValues.forEach(e=>{r[`${t}-justify-${e}`]={justifyContent:e}}),r})(n)]},()=>({}),{resetStyle:!1})}),a("5XBQv",function(a,n){t(a.exports,"flexWrapValues",()=>o),t(a.exports,"justifyContentValues",()=>s),t(a.exports,"alignItemsValues",()=>i),t(a.exports,"default",()=>c);var l=r("8g1PZ");let o=["wrap","nowrap","wrap-reverse"],s=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],i=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"];var c=function(t,r){return e(l)(Object.assign(Object.assign(Object.assign({},((e,t)=>{let r=!0===t.wrap?"wrap":t.wrap;return{[`${e}-wrap-${r}`]:r&&o.includes(r)}})(t,r)),((e,t)=>{let r={};return i.forEach(a=>{r[`${e}-align-${a}`]=t.align===a}),r[`${e}-align-stretch`]=!t.align&&!!t.vertical,r})(t,r)),((e,t)=>{let r={};return s.forEach(a=>{r[`${e}-justify-${a}`]=t.justify===a}),r})(t,r)))}}),a("2qtef",function(a,n){t(a.exports,"SpinButton",()=>i),t(a.exports,"ConfirmButton",()=>c);var l=r("ayMG0"),o=r("acw62"),s=r("4Uh7a");let i=e(o).forwardRef(({onClickAsync:e,...t},r)=>{let[a,n]=(0,o.useState)(!1),i=async()=>{if(!a)try{n(!0),await e()}finally{n(!1)}};return(0,l.jsx)(s.default,{...t,ref:r,loading:a,onClick:i})});i.displayName="SpinButton";let c=e(o).forwardRef(({onClickAsync:e,confirmTimeout:t,confirmTitle:r,children:a,...n},s)=>{let[c,u]=(0,o.useState)(!1);void 0===t&&(t=2e3);let d=async()=>{if(!c){u(!0),setTimeout(()=>{u(!1)},t);return}u(!1),await e()};return(0,l.jsx)(i,{...n,ref:s,onClickAsync:d,children:c?r:a})});c.displayName="ConfirmButton"}),a("cLBHq",function(e,t){e.exports=Promise.all([import("4Newn"),import("4JhbG")]).then(()=>r("9Y6qv"))}),a("lkdpj",function(e,t){e.exports=import("lR4DZ").then(()=>r("fFsUW"))}),a("bmzDK",function(e,r){t(e.exports,"isMobile",()=>a);let a=()=>window.innerWidth<=1024||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}),a("bDRCH",function(a,n){t(a.exports,"URIAutocomplete",()=>p);var l=r("ayMG0"),o=r("ahXgR"),s=r("acw62"),i=r("3xSyo"),c=r("1Yxub"),u=r("f1q41");let d=i.isWindows?"\\":"/",p=t=>{let[r,a]=(0,s.useState)(""),[n,p]=(0,s.useState)([]),[f,h]=(0,s.useState)([]);(0,s.useEffect)(()=>{h(n.filter(e=>-1!==e.value.indexOf(r)))},[n]);let m=e(u).debounce(e=>{a(e);let t=e.lastIndexOf(d);-1!==t&&(e=e.substring(0,t)),c.backrestService.pathAutocomplete({value:e+d}).then(t=>{t.values&&p(t.values.map(t=>({value:e+d+t})))}).catch(e=>{console.log("Path autocomplete error: ",e)})},200);return(0,l.jsx)(o.default,{options:f,onSearch:m,rules:[{validator:async(e,r)=>{if(t.globAllowed)return Promise.resolve();if(i.isWindows){if(r.match(/^[a-zA-Z]:\\$/))return Promise.reject(Error("Path must start with a drive letter e.g. C:\\"));else if(r.includes("/"))return Promise.reject(Error("Path must use backslashes e.g. C:\\Users\\MyUsers\\Documents"))}return Promise.resolve()}}],...t})}}),a("ahXgR",function(e,a){t(e.exports,"default",()=>d);var n=r("1pcHX"),l=r("ctW3E"),o=r("2lwvh"),s=r("lFZNR");let{Option:i}=o.default,c=(0,l.default)(s.default,"dropdownAlign",e=>(0,n.default)(e,["visible"])),u=s.default;u.Option=i,u._InternalPanelDoNotUseOrYouWillBeFired=c;var d=u}),a("lFZNR",function(a,n){t(a.exports,"default",()=>h);var l=r("acw62"),o=r("8g1PZ"),s=r("jWR62"),i=r("1pcHX"),c=r("brFSt"),u=r("aT8OD"),d=r("2lwvh");let{Option:p}=d.default;function f(e){return(null==e?void 0:e.type)&&(e.type.isSelectOption||e.type.isSelectOptGroup)}var h=l.forwardRef((t,r)=>{var a,n;let h,m,{prefixCls:y,className:x,popupClassName:g,dropdownClassName:v,children:k,dataSource:w,dropdownStyle:S,dropdownRender:R,popupRender:b,onDropdownVisibleChange:j,onOpenChange:O,styles:C,classNames:T}=t,N=(0,s.default)(k),A=(null==(a=null==C?void 0:C.popup)?void 0:a.root)||S,E=(null==(n=null==T?void 0:T.popup)?void 0:n.root)||g||v;1===N.length&&l.isValidElement(N[0])&&!f(N[0])&&([h]=N);let P=h?()=>h:void 0;m=N.length&&f(N[0])?k:w?w.map(e=>{if(l.isValidElement(e))return e;switch(typeof e){case"string":return l.createElement(p,{key:e,value:e},e);case"object":{let{value:t}=e;return l.createElement(p,{key:t,value:t},e.text)}default:return}}):[];let{getPrefixCls:I}=l.useContext(u.ConfigContext),B=I("select",y),[q]=(0,c.useZIndex)("SelectLike",null==A?void 0:A.zIndex);return l.createElement(d.default,Object.assign({ref:r,suffixIcon:null},(0,i.default)(t,["dataSource","dropdownClassName","popupClassName"]),{prefixCls:B,classNames:{popup:{root:E},root:null==T?void 0:T.root},styles:{popup:{root:Object.assign(Object.assign({},A),{zIndex:q})},root:null==C?void 0:C.root},className:e(o)(`${B}-auto-complete`,x),mode:d.default.SECRET_COMBOBOX_MODE_DO_NOT_USE,popupRender:b||R,onOpenChange:O||j,getInputElement:P}),m)})}),a("bUBaJ",function(e,a){t(e.exports,"default",()=>i);var n=r("8nd05"),l=r("acw62"),o=r("h6oXS"),s=r("adRcI"),i=l.forwardRef(function(e,t){return l.createElement(s.default,(0,n.default)({},e,{ref:t,icon:o.default}))})}),a("h6oXS",function(e,r){t(e.exports,"default",()=>a);var a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 00140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z"}}]},name:"up",theme:"outlined"}});
//# sourceMappingURL=RepoView.49803bb4.js.map
